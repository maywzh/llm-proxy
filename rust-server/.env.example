# LLM Proxy Environment Variables (Rust Server)
# Copy this file to .env and fill in your actual values
# DO NOT commit .env to version control!

# =============================================================================
# REQUIRED
# =============================================================================

# PostgreSQL connection string for dynamic configuration
# Format: postgresql://user:password@host:port/database?sslmode=disable
# Special characters in password are automatically URL-encoded by the server.
DB_URL=postgresql://llm_proxy:password@localhost:5432/llm_proxy?sslmode=disable

# Admin API authentication key
# Used to authenticate requests to /admin/v1/* endpoints
ADMIN_KEY=your-secure-admin-key-here

# =============================================================================
# OPTIONAL
# =============================================================================

# Server port (default: 17999)
PORT=17999

# Log level: trace, debug, info, warn, error (default: info)
LOG_LEVEL=info

# Rust-specific log configuration (overrides LOG_LEVEL if set)
# RUST_LOG=info

# Optional model name prefix (e.g., "Proxy")
# When set, model names like "Proxy/gpt-4" are treated as "gpt-4"
# PROVIDER_SUFFIX=Proxy

# =============================================================================
# LANGFUSE OBSERVABILITY (OPTIONAL)
# =============================================================================

# Enable Langfuse tracing (default: false)
# LANGFUSE_ENABLED=true

# Langfuse public key (required when LANGFUSE_ENABLED=true)
# Get from: https://cloud.langfuse.com -> Project Settings -> API Keys
# LANGFUSE_PUBLIC_KEY=pk-lf-...

# Langfuse secret key (required when LANGFUSE_ENABLED=true)
# LANGFUSE_SECRET_KEY=sk-lf-...

# Langfuse server URL (default: https://cloud.langfuse.com)
# Use this for self-hosted Langfuse instances
# LANGFUSE_HOST=https://cloud.langfuse.com

# Sampling rate 0.0-1.0 (default: 1.0)
# Set to lower value for high-traffic scenarios
# LANGFUSE_SAMPLE_RATE=1.0

# Flush interval in seconds (default: 5)
# LANGFUSE_FLUSH_INTERVAL=5

# Enable debug logging for Langfuse (default: false)
# LANGFUSE_DEBUG=false

# =============================================================================
# ADAPTIVE ROUTING (OPTIONAL)
# =============================================================================

# Enable adaptive provider routing with circuit breaker (default: false)
# ADAPTIVE_ROUTING_ENABLED=false

# Minimum weight multiplier when provider is penalized (default: 0.05)
# ADAPTIVE_MIN_MULTIPLIER=0.05

# Weight factor during half-open probe state (default: 0.2)
# ADAPTIVE_HALF_OPEN_WEIGHT_FACTOR=0.2

# Multiplier recovery increment per success (default: 0.1)
# ADAPTIVE_SUCCESS_RECOVERY_STEP=0.1

# Slow-start window in seconds after recovery (default: 60)
# ADAPTIVE_SLOW_START_WINDOW_SECS=60

# Consecutive 429 errors before circuit opens (default: 3)
# ADAPTIVE_429_THRESHOLD=3

# Consecutive 5xx errors before circuit opens (default: 5)
# ADAPTIVE_5XX_THRESHOLD=5

# Consecutive transport errors before circuit opens (default: 4)
# ADAPTIVE_TRANSPORT_THRESHOLD=4

# Successes needed in half-open to close circuit (default: 2)
# ADAPTIVE_HALF_OPEN_SUCCESS_THRESHOLD=2

# Base cooldown for 429 rate limit in seconds (default: 15)
# ADAPTIVE_BASE_429_COOLDOWN_SECS=15

# Max cooldown for 429 rate limit in seconds (default: 300)
# ADAPTIVE_MAX_429_COOLDOWN_SECS=300

# Base circuit-open duration in seconds (default: 30)
# ADAPTIVE_BASE_OPEN_DURATION_SECS=30

# Max circuit-open duration in seconds (default: 300)
# ADAPTIVE_MAX_OPEN_DURATION_SECS=300
